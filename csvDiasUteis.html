<script>
    let ano = 2025;

    //mes comeca em 0
    //https://www.anbima.com.br/feriados/fer_nacionais/2025.asp
    //https://www.anbima.com.br/feriados/feriados.asp
    //https://www.b3.com.br/pt_br/noticias/calendario-de-feriados-2025.htm
    var feriados =
        [
            new Date(ano, 1 - 1, 1),//
            new Date(ano, 3 - 1, 3),//
            new Date(ano, 3 - 1, 4),//
            new Date(ano, 4 - 1, 18),//
            new Date(ano, 4 - 1, 21),//
            new Date(ano, 5 - 1, 1),//
            new Date(ano, 6 - 1, 19),//
            new Date(ano, 9 - 1, 7),//
            new Date(ano, 10 - 1, 12),//
            new Date(ano, 11 - 1, 2),//
            new Date(ano, 11 - 1, 15),//
            new Date(ano, 11 - 1, 20),//
            new Date(ano, 12 - 1, 24),//
            new Date(ano, 12 - 1, 25),//
            new Date(ano, 12 - 1, 31),//
            new Date(ano + 1, 1 - 1, 1),//
        ];

    function downloadCSV(csvContent) {
        const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
        const url = URL.createObjectURL(blob);

        // Open directly in a new tab (triggers download in most browsers)
        window.open(url);

        // Optional: clean up after a short delay
        setTimeout(() => URL.revokeObjectURL(url), 1000);
    }

    async function process() {
        let csvContent = "";

        var date = new Date(ano, 1 - 1, 1);
        for (let i = 1; i < 367; i++) {
            if (!feriados.some(d => d.getTime() == date.getTime()) && (date.getDay() != 0 && date.getDay() != 6))
                csvContent += date.toLocaleDateString('pt-br') + "\r\n";
            date.setDate(date.getDate() + 1);
        }

        downloadCSV(csvContent);
    }

    process();
</script>
